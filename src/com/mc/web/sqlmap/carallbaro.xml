<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="carallbaro">

	<select id="list" parameterType="Map" resultType="mcmap">
		SELECT 
			PT1.* 
		FROM (
			SELECT 
				PT1_SUB.*, 
				ROW_NUMBER() OVER(ORDER BY PT1_SUB.SEQ DESC) RN
			FROM (
				SELECT
					T1.SEQ,
					T1.TITLE,
					T1.CONTENT,
					T1.CARMAKERSEQ,
					T1.SIDO_CD,
					T1.SIGUNGU_CD,
					T1.REG_NM,
					T1.REG_SEQ,
					T1.TEL,
					T1.PASSWORD,
					T1.MEMBER_YN,
					T1.SET_TYPE,
					T1.TYPE_STATE,
					T1.INSURANCE_YN,
					T1.RENT_YN,
					T1.PICKUP_YN,
					TO_CHAR(T1.TOW_DATE,'yyyy-mm-dd') AS TOW_DATE,
					T1.TOW_TIME,
					T1.TOW_TYPE,
					TO_CHAR(T1.REG_DT,'yyyy-mm-dd') AS REG_DT,
					T1.DEL_YN,
					T1.STATE,
					TO_CHAR(T1.RESERV_DT,'yyyy-mm-dd') AS RESERV_DT,
					T1.THUMB,
					T1.CARINFO,
					T2.MAKERNM,
					T4.DONG_NM AS SIDO_NM,
					T5.DONG_NM AS SIGUNGU_NM,
					CASE
						WHEN T6.CNT IS NOT NULL THEN T6.CNT
						ELSE 0
					END AS COMMENT_CNT,
					CASE
						WHEN T3.UUID IS NOT NULL THEN '/upload/board/' || T3.YYYY || '/' || T3.MM || '/' || T3.UUID
						ELSE ''
					END AS FILE_THUMB
				FROM 
					NSH_CARALLBARO T1
            		LEFT OUTER JOIN V_IS_CARMAKER T2 ON T2.CARMAKERSEQ = T1.CARMAKERSEQ
            		LEFT OUTER JOIN NSH_ATTACH T3 ON T3.TABLE_NM = 'NSH_CARALLBARO' AND T3.TABLE_SEQ = T1.SEQ AND T3.ORDER_SEQ = 1
            		LEFT OUTER JOIN (
            			SELECT 
            				SIDO, DONG_NM 
            			FROM 
            				NSH_DONG 
            			WHERE 
            				USE_YN='Y' 
            			AND (
            					(SIDO = '36' and SIGUNGU='110' AND DONG='000') 
            				OR 
            					(SIGUNGU='000' AND DONG='000')
            			)
            		) T4 ON T4.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN (
            			SELECT
		    				SIDO,
		    				SIGUNGU,
		    				CASE 
		    					WHEN length(DONG_NM) -length(replace(DONG_NM, ' ', ''))=0 THEN DONG_NM
            					ELSE TRIM(FN_GET_SPLIT(DONG_NM, 2, ' ', '')) || ' ' || FN_GET_SPLIT(DONG_NM, 3, ' ', '') 
            				END AS DONG_NM
            			FROM
            				NSH_DONG
						WHERE 
							USE_YN='Y'
					    AND SIGUNGU != '000'
					    AND DONG='000'
            		) T5 ON T5.SIGUNGU = T1.SIGUNGU_CD AND T5.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN(
            			SELECT DISTINCT ARTICLE_SEQ, COUNT(COMMENT_SEQ) AS CNT FROM NSH_COMMENT WHERE DEL_YN='N' GROUP BY ARTICLE_SEQ
            		) T6 ON T6.ARTICLE_SEQ = T1.SEQ
				WHERE
					T1.DEL_YN='N'
				AND T1.SET_TYPE IN (${set_type})
				AND T1.TYPE_STATE = #{type_state}
			) PT1_SUB
			WHERE 
				DEL_YN = 'N'
			<if test="!(keyword == '' or keyword == null)">
			AND ${condition} like '%${keyword}%'
			</if>
			<if test="!(myarticle == '' or myarticle == null)">
			AND REG_SEQ = #{session_member_seq}
			</if>
		) PT1
		WHERE CEIL(RN/NVL(#{rows, jdbcType=INTEGER},10))=NVL(#{cpage, jdbcType=INTEGER},1)  ORDER BY RN ASC
	</select>
	
	<select id="pagination" parameterType="Map" resultType="mcmap">
		SELECT 
			CEIL(COUNT(1)/NVL(#{rows, jdbcType=INTEGER},10)) TOTALPAGE,
			COUNT(1) TOTALCOUNT
		FROM (
			SELECT 
				PT1_SUB.*, 
				ROW_NUMBER() OVER(ORDER BY PT1_SUB.SEQ DESC) RN
			FROM (
				SELECT
					T1.SEQ,
					T1.TITLE,
					T1.CONTENT,
					T1.CARMAKERSEQ,
					T1.SIDO_CD,
					T1.SIGUNGU_CD,
					T1.REG_NM,
					T1.REG_SEQ,
					T1.TEL,
					T1.PASSWORD,
					T1.MEMBER_YN,
					T1.SET_TYPE,
					T1.TYPE_STATE,
					T1.INSURANCE_YN,
					T1.RENT_YN,
					T1.PICKUP_YN,
					TO_CHAR(T1.TOW_DATE,'yyyy-mm-dd') AS TOW_DATE,
					T1.TOW_TIME,
					T1.TOW_TYPE,
					TO_CHAR(T1.REG_DT,'yyyy-mm-dd') AS REG_DT,
					T1.DEL_YN,
					T1.STATE,
					TO_CHAR(T1.RESERV_DT,'yyyy-mm-dd') AS RESERV_DT,
					T1.THUMB,
					T1.CARINFO,
					T2.MAKERNM,
					T4.DONG_NM AS SIDO_NM,
					T5.DONG_NM AS SIGUNGU_NM,
					CASE
						WHEN T3.UUID IS NOT NULL THEN '/upload/board/' || T3.YYYY || '/' || T3.MM || '/' || T3.UUID
						ELSE ''
					END AS FILE_THUMB
				FROM 
					NSH_CARALLBARO T1
            		LEFT OUTER JOIN V_IS_CARMAKER T2 ON T2.CARMAKERSEQ = T1.CARMAKERSEQ
            		LEFT OUTER JOIN NSH_ATTACH T3 ON T3.TABLE_NM = 'NSH_CARALLBARO' AND T3.TABLE_SEQ = T1.SEQ AND T3.ORDER_SEQ = 1
            		LEFT OUTER JOIN (
            			SELECT 
            				SIDO, DONG_NM 
            			FROM 
            				NSH_DONG 
            			WHERE 
            				USE_YN='Y' 
            			AND (
            					(SIDO = '36' and SIGUNGU='110' AND DONG='000') 
            				OR 
            					(SIGUNGU='000' AND DONG='000')
            			)
            		) T4 ON T4.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN (
            			SELECT
		    				SIDO,
		    				SIGUNGU,
		    				CASE 
		    					WHEN length(DONG_NM) -length(replace(DONG_NM, ' ', ''))=0 THEN DONG_NM
            					ELSE TRIM(FN_GET_SPLIT(DONG_NM, 2, ' ', '')) || ' ' || FN_GET_SPLIT(DONG_NM, 3, ' ', '') 
            				END AS DONG_NM
            			FROM
            				NSH_DONG
						WHERE 
							USE_YN='Y'
					    AND SIGUNGU != '000'
					    AND DONG='000'
            		) T5 ON T5.SIGUNGU = T1.SIGUNGU_CD AND T5.SIDO = T1.SIDO_CD
				WHERE
					T1.DEL_YN='N'
				AND T1.SET_TYPE IN (${set_type})
				AND T1.TYPE_STATE = #{type_state}
			) PT1_SUB
			WHERE 
				DEL_YN = 'N'
			<if test="!(keyword == '' or keyword == null)">
			AND ${condition} like '%${keyword}%'
			</if>
			<if test="!(myarticle == '' or myarticle == null)">
			AND REG_SEQ = #{session_member_seq}
			</if>
		) PT1
	</select>
	
	
	
	<select id="list_carall" parameterType="Map" resultType="mcmap">
		SELECT 
			PT1.* 
		FROM (
			SELECT 
				PT1_SUB.*, 
				ROW_NUMBER() OVER(ORDER BY PT1_SUB.SEQ DESC) RN
			FROM (
				SELECT
					T1.SEQ,
					T1.TITLE,
					T1.CONTENT,
					T1.CARMAKERSEQ,
					T1.SIDO_CD,
					T1.SIGUNGU_CD,
					T1.REG_NM,
					T1.REG_SEQ,
					T1.TEL,
					T1.PASSWORD,
					T1.MEMBER_YN,
					T1.SET_TYPE,
					T1.TYPE_STATE,
					T1.INSURANCE_YN,
					T1.RENT_YN,
					T1.PICKUP_YN,
					TO_CHAR(T1.TOW_DATE,'yyyy-mm-dd') AS TOW_DATE,
					T1.TOW_TIME,
					T1.TOW_TYPE,
					TO_CHAR(T1.REG_DT,'yyyy-mm-dd') AS REG_DT,
					T1.DEL_YN,
					T1.STATE,
					TO_CHAR(T1.RESERV_DT,'yyyy-mm-dd') AS RESERV_DT,
					T1.THUMB,
					T1.CARINFO,
					T2.MAKERNM,
					T4.DONG_NM AS SIDO_NM,
					T5.DONG_NM AS SIGUNGU_NM,
					CASE
						WHEN T6.CNT IS NOT NULL THEN T6.CNT
						ELSE 0
					END AS COMMENT_CNT,
					CASE
						WHEN T3.UUID IS NOT NULL THEN '/upload/board/' || T3.YYYY || '/' || T3.MM || '/' || T3.UUID
						ELSE ''
					END AS FILE_THUMB
				FROM 
					NSH_CARALLBARO T1
            		LEFT OUTER JOIN V_IS_CARMAKER T2 ON T2.CARMAKERSEQ = T1.CARMAKERSEQ
            		LEFT OUTER JOIN NSH_ATTACH T3 ON T3.TABLE_NM = 'NSH_CARALLBARO' AND T3.TABLE_SEQ = T1.SEQ AND T3.ORDER_SEQ = 1
            		LEFT OUTER JOIN (
            			SELECT 
            				SIDO, DONG_NM 
            			FROM 
            				NSH_DONG 
            			WHERE 
            				USE_YN='Y' 
            			AND (
            					(SIDO = '36' and SIGUNGU='110' AND DONG='000') 
            				OR 
            					(SIGUNGU='000' AND DONG='000')
            			)
            		) T4 ON T4.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN (
            			SELECT
		    				SIDO,
		    				SIGUNGU,
		    				CASE 
		    					WHEN length(DONG_NM) -length(replace(DONG_NM, ' ', ''))=0 THEN DONG_NM
            					ELSE TRIM(FN_GET_SPLIT(DONG_NM, 2, ' ', '')) || ' ' || FN_GET_SPLIT(DONG_NM, 3, ' ', '') 
            				END AS DONG_NM
            			FROM
            				NSH_DONG
						WHERE 
							USE_YN='Y'
					    AND SIGUNGU != '000'
					    AND DONG='000'
            		) T5 ON T5.SIGUNGU = T1.SIGUNGU_CD AND T5.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN(
            			SELECT DISTINCT ARTICLE_SEQ, COUNT(COMMENT_SEQ) AS CNT FROM NSH_COMMENT WHERE DEL_YN='N' GROUP BY ARTICLE_SEQ
            		) T6 ON T6.ARTICLE_SEQ = T1.SEQ
            		LEFT OUTER JOIN NSH_COOPERATION T7 ON T7.SEQ = #{com_seq}
				WHERE
					T1.DEL_YN='N'
				AND T1.SET_TYPE IN (${set_type})
				AND T1.TYPE_STATE = #{type_state}
				AND T7.SIDO_CD = T1.SIDO_CD AND T7.SIGUNGU_CD = T1.SIGUNGU_CD
			) PT1_SUB
			WHERE 
				DEL_YN = 'N'
			<if test="!(keyword == '' or keyword == null)">
			AND ${condition} like '%${keyword}%'
			</if>
			<if test="!(myarticle == '' or myarticle == null)">
			AND REG_SEQ = #{session_member_seq}
			</if>
		) PT1
		WHERE CEIL(RN/NVL(#{rows, jdbcType=INTEGER},10))=NVL(#{cpage, jdbcType=INTEGER},1)  ORDER BY RN ASC
	</select>
	
	<select id="pagination_carall" parameterType="Map" resultType="mcmap">
		SELECT 
			CEIL(COUNT(1)/NVL(#{rows, jdbcType=INTEGER},10)) TOTALPAGE,
			COUNT(1) TOTALCOUNT
		FROM (
			SELECT 
				PT1_SUB.*, 
				ROW_NUMBER() OVER(ORDER BY PT1_SUB.SEQ DESC) RN
			FROM (
				SELECT
					T1.SEQ,
					T1.TITLE,
					T1.CONTENT,
					T1.CARMAKERSEQ,
					T1.SIDO_CD,
					T1.SIGUNGU_CD,
					T1.REG_NM,
					T1.REG_SEQ,
					T1.TEL,
					T1.PASSWORD,
					T1.MEMBER_YN,
					T1.SET_TYPE,
					T1.TYPE_STATE,
					T1.INSURANCE_YN,
					T1.RENT_YN,
					T1.PICKUP_YN,
					TO_CHAR(T1.TOW_DATE,'yyyy-mm-dd') AS TOW_DATE,
					T1.TOW_TIME,
					T1.TOW_TYPE,
					TO_CHAR(T1.REG_DT,'yyyy-mm-dd') AS REG_DT,
					T1.DEL_YN,
					T1.STATE,
					TO_CHAR(T1.RESERV_DT,'yyyy-mm-dd') AS RESERV_DT,
					T1.THUMB,
					T1.CARINFO,
					T2.MAKERNM,
					T4.DONG_NM AS SIDO_NM,
					T5.DONG_NM AS SIGUNGU_NM,
					CASE
						WHEN T3.UUID IS NOT NULL THEN '/upload/board/' || T3.YYYY || '/' || T3.MM || '/' || T3.UUID
						ELSE ''
					END AS FILE_THUMB
				FROM 
					NSH_CARALLBARO T1
            		LEFT OUTER JOIN V_IS_CARMAKER T2 ON T2.CARMAKERSEQ = T1.CARMAKERSEQ
            		LEFT OUTER JOIN NSH_ATTACH T3 ON T3.TABLE_NM = 'NSH_CARALLBARO' AND T3.TABLE_SEQ = T1.SEQ AND T3.ORDER_SEQ = 1
            		LEFT OUTER JOIN (
            			SELECT 
            				SIDO, DONG_NM 
            			FROM 
            				NSH_DONG 
            			WHERE 
            				USE_YN='Y' 
            			AND (
            					(SIDO = '36' and SIGUNGU='110' AND DONG='000') 
            				OR 
            					(SIGUNGU='000' AND DONG='000')
            			)
            		) T4 ON T4.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN (
            			SELECT
		    				SIDO,
		    				SIGUNGU,
		    				CASE 
		    					WHEN length(DONG_NM) -length(replace(DONG_NM, ' ', ''))=0 THEN DONG_NM
            					ELSE TRIM(FN_GET_SPLIT(DONG_NM, 2, ' ', '')) || ' ' || FN_GET_SPLIT(DONG_NM, 3, ' ', '') 
            				END AS DONG_NM
            			FROM
            				NSH_DONG
						WHERE 
							USE_YN='Y'
					    AND SIGUNGU != '000'
					    AND DONG='000'
            		) T5 ON T5.SIGUNGU = T1.SIGUNGU_CD AND T5.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN NSH_COOPERATION T7 ON T7.SEQ = #{com_seq}
				WHERE
					T1.DEL_YN='N'
				AND T1.SET_TYPE IN (${set_type})
				AND T1.TYPE_STATE = #{type_state}
				AND T7.SIDO_CD = T1.SIDO_CD AND T7.SIGUNGU_CD = T1.SIGUNGU_CD
			) PT1_SUB
			WHERE 
				DEL_YN = 'N'
			<if test="!(keyword == '' or keyword == null)">
			AND ${condition} like '%${keyword}%'
			</if>
			<if test="!(myarticle == '' or myarticle == null)">
			AND REG_SEQ = #{session_member_seq}
			</if>
		) PT1
	</select>
	
	
	<select id="view" parameterType="Map" resultType="mcmap">
		SELECT 
			PT1.* 
		FROM (
			SELECT 
				PT1_SUB.*, 
				ROW_NUMBER() OVER(ORDER BY PT1_SUB.SEQ DESC) RN
			FROM (
				SELECT
					T1.SEQ,
					T1.TITLE,
					T1.CONTENT,
					T1.CARMAKERSEQ,
					T1.SIDO_CD,
					T1.SIGUNGU_CD,
					T1.REG_NM,
					T1.TEL,
					T1.PASSWORD,
					T1.MEMBER_YN,
					T1.SET_TYPE,
					T1.TYPE_STATE,
					T1.INSURANCE_YN,
					T1.RENT_YN,
					T1.PICKUP_YN,
					TO_CHAR(T1.TOW_DATE,'yyyy-mm-dd') AS TOW_DATE,
					T1.TOW_TIME,
					T1.TOW_TYPE,
					TO_CHAR(T1.REG_DT,'yyyy-mm-dd') AS REG_DT,
					T1.DEL_YN,
					T1.STATE,
					TO_CHAR(T1.RESERV_DT,'yyyy-mm-dd') AS RESERV_DT,
					T1.THUMB,
					T1.CARINFO,
					T2.MAKERNM,
					T4.DONG_NM AS SIDO_NM,
					T5.DONG_NM AS SIGUNGU_NM,
					CASE
						WHEN T6.CNT IS NOT NULL THEN T6.CNT
						ELSE 0
					END AS COMMENT_CNT,
					CASE
						WHEN T3.UUID IS NOT NULL THEN '/upload/board/' || T3.YYYY || '/' || T3.MM || '/' || T3.UUID
						ELSE ''
					END AS FILE_THUMB
				FROM 
					NSH_CARALLBARO T1
            		LEFT OUTER JOIN V_IS_CARMAKER T2 ON T2.CARMAKERSEQ = T1.CARMAKERSEQ
            		LEFT OUTER JOIN NSH_ATTACH T3 ON T3.TABLE_NM = 'NSH_CARALLBARO' AND T3.TABLE_SEQ = T1.SEQ AND T3.ORDER_SEQ = 1
            		LEFT OUTER JOIN (
            			SELECT 
            				SIDO, DONG_NM 
            			FROM 
            				NSH_DONG 
            			WHERE 
            				USE_YN='Y' 
            			AND (
            					(SIDO = '36' and SIGUNGU='110' AND DONG='000') 
            				OR 
            					(SIGUNGU='000' AND DONG='000')
            			)
            		) T4 ON T4.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN (
            			SELECT
		    				SIDO,
		    				SIGUNGU,
		    				CASE 
		    					WHEN length(DONG_NM) -length(replace(DONG_NM, ' ', ''))=0 THEN DONG_NM
            					ELSE TRIM(FN_GET_SPLIT(DONG_NM, 2, ' ', '')) || ' ' || FN_GET_SPLIT(DONG_NM, 3, ' ', '') 
            				END AS DONG_NM
            			FROM
            				NSH_DONG
						WHERE 
							USE_YN='Y'
					    AND SIGUNGU != '000'
					    AND DONG='000'
            		) T5 ON T5.SIGUNGU = T1.SIGUNGU_CD AND T5.SIDO = T1.SIDO_CD
            		LEFT OUTER JOIN(
            			SELECT DISTINCT ARTICLE_SEQ, COUNT(COMMENT_SEQ) AS CNT FROM NSH_COMMENT WHERE DEL_YN='N' GROUP BY ARTICLE_SEQ
            		) T6 ON T6.ARTICLE_SEQ = T1.SEQ
				WHERE
					T1.DEL_YN='N'
				AND T1.SEQ = #{seq}
			) PT1_SUB
		) PT1
	</select>
	
	<insert id="insert" parameterType="map">
		INSERT INTO NSH_CARALLBARO (
			SEQ,
			TITLE,
			CONTENT,
			CARMAKERSEQ,
			<if test="!(sido_cd == '' or sido_cd == null)">
			SIDO_CD,
			</if>
			<if test="!(sigungu_cd == '' or sigungu_cd == null)">
			SIGUNGU_CD,
			</if>
			<if test="!(tel == '' or tel == null)">
			TEL,
			</if>
			<if test="!(password == '' or password == null)">
			PASSWORD,
			</if>
			MEMBER_YN,
			SET_TYPE,
			TYPE_STATE,
			<if test="!(insurance_yn == '' or insurance_yn == null)">
			INSURANCE_YN,
			</if>
			<if test="!(rent_yn == '' or rent_yn == null)">
			RENT_YN,
			</if>
			<if test="!(pickup_yn == '' or pickup_yn == null)">
			PICKUP_YN,
			</if>
			<if test="!(tow_date == '' or tow_date == null)">
			TOW_DATE,
			</if>
			<if test="!(tow_time == '' or tow_time == null)">
			TOW_TIME,
			</if>
			<if test="!(tow_type == '' or tow_type == null)">
			TOW_TYPE,
			</if>
			REG_DT,
			REG_SEQ,
			REG_NM,
			STATE,
			<if test="!(reserv_dt == '' or reserv_dt == null)">
			RESERV_DT,
			</if>
			<if test="!(thumb == '' or thumb == null)">
			THUMB,
			</if>
			<if test="!(carinfo == '' or carinfo == null)">
			CARINFO,
			</if>			
			DEL_YN
		)VALUES(
			#{seq},
			#{title},
			#{content},
			#{carmakerseq},
			<if test="!(sido_cd == '' or sido_cd == null)">
			#{sido_cd},
			</if>
			<if test="!(sigungu_cd == '' or sigungu_cd == null)">
			#{sigungu_cd},
			</if>
			<if test="!(tel == '' or tel == null)">
			#{tel},
			</if>
			<if test="!(password == '' or password == null)">
			#{password},
			</if>
			#{member_yn},
			#{set_type},
			#{type_state},
			<if test="!(insurance_yn == '' or insurance_yn == null)">
			#{insurance_yn},
			</if>
			<if test="!(rent_yn == '' or rent_yn == null)">
			#{rent_yn},
			</if>
			<if test="!(pickup_yn == '' or pickup_yn == null)">
			#{pickup_yn},
			</if>
			<if test="!(tow_date == '' or tow_date == null)">
			TO_DATE(#{tow_date}, 'YYYY-MM-DD'),
			</if>
			<if test="!(tow_time == '' or tow_time == null)">
			#{tow_time},
			</if>
			<if test="!(tow_type == '' or tow_type == null)">
			#{tow_type},
			</if>
			SYSDATE,
			#{session_member_seq},
			#{session_member_nm},
			#{state},
			<if test="!(reserv_dt == '' or reserv_dt == null)">
			TO_DATE(#{reserv_dt}, 'YYYY-MM-DD'),
			</if>
			<if test="!(thumb == '' or thumb == null)">
			#{thumb},
			</if>
			<if test="!(carinfo == '' or carinfo == null)">
			#{carinfo},
			</if>
			'N'
		)
	</insert>
	
	<update id="update" parameterType="Map">
		UPDATE NSH_CARALLBARO SET
			<if test="!(title == '' or title == null)"> 
			TITLE = #{title},
			</if>
			CONTENT = #{content},
			CARMAKERSEQ = #{carmakerseq},
			<if test="!(sido_cd == '' or sido_cd == null)">
			SIDO_CD = #{sido_cd},
			</if>
			<if test="!(sigungu_cd == '' or sigungu_cd == null)">
			SIGUNGU_CD = #{sigungu_cd},
			</if>
			<if test="!(tel == '' or tel == null)">
			TEL = #{tel},
			</if>
			<if test="!(password == '' or password == null)">
			PASSWORD = #{password},
			</if>
			<if test="!(member_yn == '' or member_yn == null)">
			MEMBER_YN = #{member_yn},
			</if>
			<if test="!(set_type == '' or set_type == null)">
			SET_TYPE = #{set_type},
			</if>
			<if test="!(type_state == '' or type_state == null)">
			TYPE_STATE = #{type_state},
			</if>
			<if test="!(insurance_yn == '' or insurance_yn == null)">
			INSURANCE_YN = #{insurance_yn},
			</if>
			<if test="!(rent_yn == '' or rent_yn == null)">
			RENT_YN = #{rent_yn},
			</if>
			<if test="!(pickup_yn == '' or pickup_yn == null)">
			PICKUP_YN = #{pickup_yn},
			</if>
			<if test="!(tow_date == '' or tow_date == null)">
			TOW_DATE = TO_DATE(#{tow_date}, 'YYYY-MM-DD'),
			</if>
			<if test="!(tow_time == '' or tow_time == null)">
			TOW_TIME = #{tow_time},
			</if>
			<if test="!(tow_type == '' or tow_type == null)">
			TOW_TYPE = #{tow_type},
			</if>
			STATE = #{state},
			<if test="!(reserv_dt == '' or reserv_dt == null)">
			RESERV_DT = TO_DATE(#{reserv_dt}, 'YYYY-MM-DD'),
			</if>
			<if test="!(thumb == '' or thumb == null)">
			THUMB = #{thumb},
			</if>
			<if test="!(carinfo == '' or carinfo == null)">
			CARINFO = #{carinfo},
			</if>
			MOD_DT=SYSDATE,
			MOD_SEQ=#{session_member_seq},
			MOD_NM=#{session_member_nm}
		WHERE SEQ = #{seq}
	</update>
	
	<update id="delete" parameterType="Map">
		UPDATE NSH_CARALLBARO SET 
			DEL_YN='Y', 
			DEL_DT=SYSDATE, 
			DEL_SEQ=#{session_member_seq}, 
			DEL_NM=#{session_member_nm}
		WHERE SEQ in (${seq})
	</update>
</mapper>